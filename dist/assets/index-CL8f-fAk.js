(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))r(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(t){if(t.ep)return;t.ep=!0;const s=n(t);fetch(t.href,s)}})();async function f(){try{const e=await fetch("https://gist.githubusercontent.com/baiello/0a974b9c1ec73d7d0ed7c8abc361fc8e/raw/e598efa6ef42d34cc8d7e35da5afab795941e53e/recipes.json");if(!e.ok)throw new Error("Erreur réseau");const i=await e.json();return i.forEach(n=>n.image=n.image.replace(".jpg",".webp")),i}catch(e){return console.error("Erreur lors de la récupération des recettes :",e),alert("Erreur de chargement des recettes. Veuillez réessayer plus tard."),[]}}function o(e){return(e==null?void 0:e.toLowerCase().trim())||""}function w(e,i){let n;return function(...r){clearTimeout(n),n=setTimeout(()=>e(...r),i)}}function g(e,i,n){if(!Array.isArray(e))return console.error("Expected 'recipes' to be an array but got:",e),[];const r=o(i);return e.filter(t=>{const s=t.name.toLowerCase().includes(r),c=n.every(a=>t.ingredients.some(l=>o(l.ingredient).includes(a))||t.appliance&&o(t.appliance).includes(a)||t.ustensils&&t.ustensils.some(l=>o(l).includes(a)));return s&&c})}function y(){return Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(e=>o(e.value))}function E(e,i,n){Array.from(e).sort().forEach(r=>{const t=document.createElement("label"),s=document.createElement("input");s.type="checkbox",s.name=n,s.value=r,t.appendChild(s),t.appendChild(document.createTextNode(r)),i.appendChild(t),i.appendChild(document.createElement("br")),s.addEventListener("change",()=>h(window.allRecipes))})}function u(e,i,n){const r=document.getElementById(e);r.innerHTML="",E(i,r,n)}function m(e,i=""){const n=new Set,r=new Set,t=new Set;g(e,i,[]).forEach(c=>{c.appliance&&n.add(o(c.appliance)),c.ingredients.forEach(a=>r.add(o(a.ingredient))),c.ustensils.forEach(a=>t.add(o(a)))}),u("appareilsList",n,"appareils"),u("ingredientsList",r,"ingredients"),u("ustensilesList",t,"ustensiles")}function h(e){const i=document.querySelectorAll('input[type="checkbox"]'),n=document.getElementById("filterList");n.innerHTML="",i.forEach(t=>{if(t.checked){const s=document.createElement("button");s.innerHTML=`<p>${t.value}</p><i class="fa-regular fa-circle-xmark"></i>`,s.onclick=()=>L(t.name,t.value,e),n.appendChild(s)}});const r=document.getElementById("big_search").value;p(e,r)}function L(e,i,n){const r=document.querySelector(`input[name="${e}"][value="${i}"]`);r&&(r.checked=!1,h(n))}function d(e){const i=document.getElementById("searchappareils").value.toLowerCase(),n=document.getElementById("searchingredients").value.toLowerCase(),r=document.getElementById("searchustensiles").value.toLowerCase(),t=new Set,s=new Set,c=new Set;e.forEach(a=>{(i===""||a.appliance&&a.appliance.toLowerCase().includes(i))&&a.appliance&&t.add(o(a.appliance)),a.ingredients.forEach(l=>{(n===""||l.ingredient.toLowerCase().includes(n))&&s.add(o(l.ingredient))}),a.ustensils.forEach(l=>{(r===""||l.toLowerCase().includes(r))&&c.add(o(l))})}),u("appareilsList",t,"appareils"),u("ingredientsList",s,"ingredients"),u("ustensilesList",c,"ustensiles"),p(e)}function p(e,i=""){if(console.log("Updating list of recipes. Received recipes:",e),!Array.isArray(e)){console.error("Expected 'recipes' to be an array but got:",e);return}const n=document.getElementById("recipesListContainer");n.innerHTML="";const r=y(),t=g(e,i,r),s=document.getElementById("numberOfRecipes");if(s.textContent=`${t.length} ${t.length>1?"recettes":"recette"}`,t.length===0){n.innerHTML="<p>Aucune recette trouvée</p>";return}t.forEach(c=>{const a=document.createElement("div");a.classList.add("list_recettes_div"),a.innerHTML=`
      <img src="./images/${c.image}" alt="Image de la recette">
      <div>
        <h2>${c.name}</h2>
        <p>${c.description}</p>
        <h3>Ingrédients</h3>
        <div class="list_ingredients">
          ${c.ingredients.map(l=>`
            <div>
              <p>${o(l.ingredient)}</p>
              <label>${l.quantity||""} ${l.unit||""}</label>
            </div>
          `).join("")}
        </div>
      </div>
    `,n.appendChild(a)})}window.allRecipes=[];document.addEventListener("DOMContentLoaded",async()=>{if(window.allRecipes=await f(),console.log("Fetched recipes:",window.allRecipes),!Array.isArray(window.allRecipes)){console.error("Expected 'allRecipes' to be an array but got:",window.allRecipes);return}if(window.allRecipes.length===0)return;m(window.allRecipes),p(window.allRecipes);const e=document.getElementById("big_search");e&&e.addEventListener("input",w(()=>{const t=e.value;m(window.allRecipes,t),p(window.allRecipes,t)},300));const i=document.getElementById("searchappareils"),n=document.getElementById("searchingredients"),r=document.getElementById("searchustensiles");i&&i.addEventListener("input",()=>d(window.allRecipes)),n&&n.addEventListener("input",()=>d(window.allRecipes)),r&&r.addEventListener("input",()=>d(window.allRecipes))});document.getElementById("searchappareils").addEventListener("input",()=>d(window.allRecipes));document.getElementById("searchingredients").addEventListener("input",()=>d(window.allRecipes));document.getElementById("searchustensiles").addEventListener("input",()=>d(window.allRecipes));document.querySelectorAll("legend").forEach(e=>{e.addEventListener("click",()=>{const i=e.nextElementSibling,n=i.style.display==="block";i.style.display=n?"none":"block",i.style.border=n?"unset":"2px solid black"})});async function v(){window.allRecipes=await f(),p(window.allRecipes),document.getElementById("big_search").addEventListener("input",e=>{p(window.allRecipes,e.target.value)}),document.getElementById("searchappareils").addEventListener("input",()=>d(window.allRecipes)),document.getElementById("searchingredients").addEventListener("input",()=>d(window.allRecipes)),document.getElementById("searchustensiles").addEventListener("input",()=>d(window.allRecipes))}v();
